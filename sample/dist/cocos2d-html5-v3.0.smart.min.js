(function(h){var e,d,c;(function(){var b={},a={};e=function(a,c,d){b[a]={deps:c,callback:d}};c=d=function(f){function k(a){if("."!==a.charAt(0))return a;a=a.split("/");for(var b=f.split("/").slice(0,-1),c=0,k=a.length;c<k;c++){var q=a[c];".."===q?b.pop():"."!==q&&b.push(q)}return b.join("/")}c._eak_seen=b;if(a[f])return a[f];a[f]={};if(!b[f])throw Error("Could not find module "+f);for(var t=b[f],g=t.deps,t=t.callback,e=[],m,n=0,p=g.length;n<p;n++)"exports"===g[n]?e.push(m={}):e.push(d(k(g[n])));g=
t.apply(this,e);return a[f]=m||g}})();e("promise/all",["./utils","exports"],function(b,a){var f=b.isArray,c=b.isFunction;a.all=function(a){if(!f(a))throw new TypeError("You must pass an array to all.");return new this(function(b,f){function d(a){return function(f){e[a]=f;0===--p&&b(e)}}var e=[],p=a.length,h;0===p&&b([]);for(var r=0;r<a.length;r++)(h=a[r])&&c(h.then)?h.then(d(r),f):(e[r]=h,0===--p&&b(e))})}});e("promise/asap",["exports"],function(b){function a(){return function(){process.nextTick(d)}}
function f(){var a=0,b=new l(d),f=document.createTextNode("");b.observe(f,{characterData:!0});return function(){f.data=a=++a%2}}function c(){return function(){m.setTimeout(d,1)}}function d(){for(var a=0;a<n.length;a++){var b=n[a];(0,b[0])(b[1])}n=[]}var e="undefined"!==typeof window?window:{},l=e.MutationObserver||e.WebKitMutationObserver,m="undefined"!==typeof h?h:void 0===this?window:this,n=[],p;p="undefined"!==typeof process&&"[object process]"==={}.toString.call(process)?a():l?f():c();b.asap=
function(a,b){1===n.push([a,b])&&p()}});e("promise/config",["exports"],function(b){var a={instrument:!1};b.config=a;b.configure=function(b,c){if(2===arguments.length)a[b]=c;else return a[b]}});e("promise/polyfill",["./promise","./utils","exports"],function(b,a,f){var c=b.Promise,d=a.isFunction;f.polyfill=function(){var a;a="undefined"!==typeof h?h:"undefined"!==typeof window&&window.document?window:self;"Promise"in a&&"resolve"in a.Promise&&"reject"in a.Promise&&"all"in a.Promise&&"race"in a.Promise&&
function(){var b;new a.Promise(function(a){b=a});return d(b)}()||(a.Promise=c)}});e("promise/promise","./config ./utils ./all ./race ./resolve ./reject ./asap exports".split(" "),function(b,a,f,c,d,e,l,m){function n(a){if(!z(a))throw new TypeError("You must pass a resolver function as the first argument to the promise constructor");if(!(this instanceof n))throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.");this._subscribers=
[];h(a,this)}function h(a,b){function f(a){q(b,a)}function c(a){v(b,a)}try{a(f,c)}catch(k){c(k)}}function s(a,b,f,c){var k=z(f),d,u,e,t;if(k)try{d=f(c),e=!0}catch(g){t=!0,u=g}else d=c,e=!0;x(b,d)||(k&&e?q(b,d):t?v(b,u):a===A?q(b,d):a===B&&v(b,d))}function r(a,b,q,f){a=a._subscribers;var c=a.length;a[c]=b;a[c+A]=q;a[c+B]=f}function w(a,b){for(var q,f,c=a._subscribers,d=a._detail,k=0;k<c.length;k+=3)q=c[k],f=c[k+b],s(b,q,f,d);a._subscribers=null}function x(a,b){var f=null,c;try{if(a===b)throw new TypeError("A promises callback cannot return that same promise.");
if(E(b)&&(f=b.then,z(f)))return f.call(b,function(f){if(c)return!0;c=!0;b!==f?q(a,f):u(a,f)},function(b){if(c)return!0;c=!0;v(a,b)}),!0}catch(k){if(c)return!0;v(a,k);return!0}return!1}function q(a,b){a===b?u(a,b):x(a,b)||u(a,b)}function u(a,b){a._state===C&&(a._state=D,a._detail=b,y.async(F,a))}function v(a,b){a._state===C&&(a._state=D,a._detail=b,y.async(G,a))}function F(a){w(a,a._state=A)}function G(a){w(a,a._state=B)}var y=b.config,E=a.objectOrFunction,z=a.isFunction;b=f.all;c=c.race;d=d.resolve;
e=e.reject;y.async=l.asap;var C=void 0,D=0,A=1,B=2;n.prototype={constructor:n,_state:void 0,_detail:void 0,_subscribers:void 0,then:function(a,b){var q=this,f=new this.constructor(function(){});if(this._state){var c=arguments;y.async(function(){s(q._state,f,c[q._state-1],q._detail)})}else r(this,f,a,b);return f},"catch":function(a){return this.then(null,a)}};n.all=b;n.race=c;n.resolve=d;n.reject=e;m.Promise=n});e("promise/race",["./utils","exports"],function(b,a){var f=b.isArray;a.race=function(a){if(!f(a))throw new TypeError("You must pass an array to race.");
return new this(function(b,f){for(var c,d=0;d<a.length;d++)(c=a[d])&&"function"===typeof c.then?c.then(b,f):b(c)})}});e("promise/reject",["exports"],function(b){b.reject=function(a){return new this(function(b,c){c(a)})}});e("promise/resolve",["exports"],function(b){b.resolve=function(a){return a&&"object"===typeof a&&a.constructor===this?a:new this(function(b){b(a)})}});e("promise/utils",["exports"],function(b){function a(a){return"function"===typeof a}var f=Date.now||function(){return(new Date).getTime()};
b.objectOrFunction=function(b){return a(b)||"object"===typeof b&&null!==b};b.isFunction=a;b.isArray=function(a){return"[object Array]"===Object.prototype.toString.call(a)};b.now=f});d("promise/polyfill").polyfill();cc.Promise=Promise;cc.Defer=function(){var b=this;this.promise=new Promise(function(a,f){b.resolve=a;b.reject=f})};cc.Defer.create=function(){return new cc.Defer}})(this);(function(h){function e(){this._events=this._events||{};this._maxListeners=this._maxListeners||void 0}e.EventEmitter=e;e.prototype._events=void 0;e.prototype._maxListeners=void 0;e.defaultMaxListeners=10;e.prototype.setMaxListeners=function(d){if(!cc.isNumber(d)||0>d||isNaN(d))throw TypeError("n must be a positive number");this._maxListeners=d;return this};e.prototype.emit=function(d){var c,b,a,f;this._events||(this._events={});if("error"===d&&!this._events.error){c=arguments[1];if(c instanceof Error)throw c;
throw Error('Uncaught, unspecified "error" event.');}b=this._events[d];if(cc.isUndefined(b))return!1;if(cc.isFunction(b))switch(arguments.length){case 1:b.call(this);break;case 2:b.call(this,arguments[1]);break;case 3:b.call(this,arguments[1],arguments[2]);break;default:c=arguments.length;a=Array(c-1);for(f=1;f<c;f++)a[f-1]=arguments[f];b.apply(this,a)}else if(cc.isObject(b)){c=arguments.length;a=Array(c-1);for(f=1;f<c;f++)a[f-1]=arguments[f];b=b.slice();c=b.length;for(f=0;f<c;f++)b[f].apply(this,
a)}return!0};e.prototype.addListener=function(d,c){var b;if(!cc.isFunction(c))throw TypeError("listener must be a function");this._events||(this._events={});this._events.newListener&&this.emit("newListener",d,cc.isFunction(c.listener)?c.listener:c);this._events[d]?cc.isObject(this._events[d])?this._events[d].push(c):this._events[d]=[this._events[d],c]:this._events[d]=c;cc.isObject(this._events[d])&&!this._events[d].warned&&(b=cc.isUndefined(this._maxListeners)?e.defaultMaxListeners:this._maxListeners)&&
0<b&&this._events[d].length>b&&(this._events[d].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[d].length),console.trace());return this};e.prototype.on=e.prototype.addListener;e.prototype.once=function(d,c){function b(){this.removeListener(d,b);a||(a=!0,c.apply(this,arguments))}if(!cc.isFunction(c))throw TypeError("listener must be a function");var a=!1;b.listener=c;this.on(d,b);
return this};e.prototype.removeListener=function(d,c){var b,a,f;if(!cc.isFunction(c))throw TypeError("listener must be a function");if(!this._events||!this._events[d])return this;b=this._events[d];f=b.length;a=-1;if(b===c||cc.isFunction(b.listener)&&b.listener===c)delete this._events[d],this._events.removeListener&&this.emit("removeListener",d,c);else if(cc.isObject(b)){for(;0<f--;)if(b[f]===c||b[f].listener&&b[f].listener===c){a=f;break}if(0>a)return this;1===b.length?(b.length=0,delete this._events[d]):
b.splice(a,1);this._events.removeListener&&this.emit("removeListener",d,c)}return this};e.prototype.removeAllListeners=function(d){var c;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[d]&&delete this._events[d],this;if(0===arguments.length){for(c in this._events)"removeListener"!==c&&this.removeAllListeners(c);this.removeAllListeners("removeListener");this._events={};return this}c=this._events[d];if(cc.isFunction(c))this.removeListener(d,
c);else if(Array.isArray(c))for(;c.length;)this.removeListener(d,c[c.length-1]);delete this._events[d];return this};e.prototype.listeners=function(d){return this._events&&this._events[d]?cc.isFunction(this._events[d])?[this._events[d]]:this._events[d].slice():[]};e.listenerCount=function(d,c){return d._events&&d._events[c]?cc.isFunction(d._events[c])?1:d._events[c].length:0};cc.EventEmitter=e})(this);(function(h){function e(a,b,f,c,d,e){k?setTimeout(function(){cc.director.getScheduler().scheduleCallbackForTarget(a,b,f/1E3,c,d,e)},0):(cc.director.getScheduler().unscheduleCallbackForTarget(a,b),cc.director.getScheduler().scheduleCallbackForTarget(a,b,f/1E3,c,d,e));l.push(b);return l.length-1}function d(a){return Array.isArray(a)}function c(a){return"string"===typeof a}function b(a){return"object"===typeof a&&null!==a}function a(a){return a.replace(/\-(\w)/ig,function(a,b){return b.toUpperCase()})}
h.console||(h.console={log:cc.log,error:cc.log,trace:cc.log,warn:cc.log});"undefined"==typeof navigator&&(cc.navigator?h.navigator=cc.navigator:(h.navigator={},navigator.userAgent="Cocos2dx Mac OSX"));var f=0<=navigator.userAgent.indexOf("Mac OSX"),k=0>navigator.userAgent.indexOf("Cocos2dx"),t=0<=navigator.userAgent.indexOf("Android"),g=0<=navigator.userAgent.indexOf("iOS");cc.isOSX=f;cc.isHtml5=k;cc.isAndroid=t;cc.isIOS=g;cc.isOpenGL=cc.sys.capabilities.opengl;cc.isOpenGL||(cc.TransitionCrossFade=
cc.TransitionFadeBL=cc.TransitionFadeTR=cc.TransitionFade);var l=[null];cc.Node.prototype.setTimeout=function(a,b){return e(this||h,a,b||0,0,0,!1)};cc.Node.prototype.setInterval=function(a,b){return e(this||h,a,b||0,cc.REPEAT_FOREVER,0,!1)};cc.Node.prototype.clearAllTimers=function(){var a=this||h;cc.director.getScheduler().unscheduleAllCallbacksForTarget(a)};cc.Node.prototype.clearInterval=cc.Node.prototype.clearTimeout=function(a){var b=this||h,f=l[a];null!=f&&(cc.director.getScheduler().unscheduleCallbackForTarget(b,
f),l[a]=null)};cc.mixin=function(a,b,f){f=f||function(a,b){if("undefined"===typeof a)return b};!0==f&&(f=function(a,b){return b});for(var c in b){var d=f(a[c],b[c],c,a,b);"undefined"!==typeof d&&(a[c]=d)}return a};cc.isArray=d;cc.isBoolean=function(a){return"boolean"===typeof a};cc.isNull=function(a){return null===a};cc.isNullOrUndefined=function(a){return null==a};cc.isNumber=function(a){return"number"===typeof a};cc.isString=c;cc.isSymbol=function(a){return"symbol"===typeof a};cc.isUndefined=function(a){return void 0===
a};cc.isRegExp=function(a){return b(a)&&"[object RegExp]"===objectToString(a)};cc.isObject=b;cc.isDate=function(a){return b(a)&&"[object Date]"===objectToString(a)};cc.isError=function(a){return b(a)&&("[object Error]"===objectToString(a)||a instanceof Error)};cc.isFunction=function(a){return"function"===typeof a};cc.random=function(a,b){if("number"===typeof a)return b=b||0,0|a+Math.random()*(b-a);if(a instanceof Array){var f=a.length;return null==b?a[0|Math.random()*f]:cc.arrayShuffle(a.slice(0)).slice(0,
b)}return Math.random()};cc.tmpl=function(a,b,f){return a=a.replace(/\{([^\{\}]*)\}/g,function(a,c){if(!c)return"";try{var q=(new Function("data","with(data){return ("+c+");}"))(b);return f?f(q,c):q}catch(d){return a}})};cc.arrayShuffle=function(a){for(var b=a.length-1;0<b;b--){var f=0|Math.random()*(b+1),c=a[b];a[b]=a[f];a[f]=c}return a};cc.StringToArray||(cc.StringToArray=function(a){return a.trim().split(/\s*,\s*/).map(function(a){return parseInt(a)})});var m={aqua:"#00FFFF",black:"#000000",blue:"#0000FF",
fuchsia:"#00ff00",grey:"#808080",gray:"#808080",green:"#008000",lime:"#00FF00",maroon:"#800000",navy:"#000080",olive:"#808000",purple:"#800080",red:"#FF0000",silver:"#C0C0C0",teal:"#008080",white:"#FFFFFF",yellow:"#FFFF00"},n=/^aqua$|^black$|^blue$|^fuchsia$|^grey|^gray$|^green$|^lime$|^maroon$|^navy$|^olive$|^purple$|^red$|^silver$|^teal$|^white$|^yellow$|^rgb\(.*?\)$|^rgba\(.*?\)$|^#[0-9a-fA-F]{3}$|^#[0-9a-fA-F]{6}$/;cc.isColorString=function(a){a=a.trim();return n.test(a)};if(!k){var p=cc.color;
cc.color=function(){var a=p.apply(cc,arguments);null==a.a&&(a.a=255);return a}}var s=cc.hexToColor;cc.hexToColor=function(a){a=a.trim();if("#"===a[0])4===a.length&&(a=a.replace(/([^#])/g,"$1$1"));else{if("transparent"==a)return cc.color(0,0,0,0);if(/^rgba?\(/.test(a))return a=a.replace(/^rgba?\(/,""),a=cc.StringToArray(a),4>a.length&&(a[3]=255),cc.color.apply(null,a);a=m[a]}a=s(a);null==a.a&&(a.a=255);return a};cc.fontFamily={_fonts:{},add:function(a,b){this._fonts[a]=b}};cc.textureCache.getTextureForKey||
(cc.textureCache.getTextureForKey=cc.textureCache.textureForKey);cc.getSpriteFrame=function(a,b){var f=cc.spriteFrameCache.getSpriteFrame(a);if(!b&&!f){var c=cc.textureCache.getTextureForKey(a);c||(c=cc.textureCache.addImage(a));!c||k&&!c._isLoaded||(f=c.getContentSize(),f=cc.SpriteFrame.create(c,cc.rect(0,0,f.width,f.height)))}return f};cc.createSprite=function(a,b){"object"!==typeof a||a instanceof cc.Sprite||null!=b||(b=a,a.texture?(a=a.texture,delete b.texture):a=cc.Sprite.create());b=b||{};if("string"===
typeof a)if("@"===a[0])a=cc.LabelTTF.create(a.slice(1));else if(/\.plist$/.test(a))a=cc.ParticleSystem.create(a);else{var f=cc.getSpriteFrame(a);a=cc.Sprite.create();f&&a.initWithSpriteFrame(f)}a.setCascadeOpacityEnabled&&a.setCascadeOpacityEnabled(!0);a.attr(b);return a};cc.makePoint2D=function(a){return d(a)?cc.p(a[0],a[1]):cc.p(a.x,a.y)};cc.makeSize2D=function(a){return d(a)?cc.size(a[0],a[1]):cc.size(a.width,a.height)};k||(cc.LabelTTF.prototype.setColor=function(a){this.getChildren()[0].setColor(a)},
cc.LabelTTF.prototype.getColor=function(){return this.getChildren()[0].getColor()});cc.Node.prototype._attr=cc.Node.prototype.attr;var r={xy:{get:function(a){return cc.p(a.x,a.y)},set:function(a,b){b=cc.makePoint2D(b);a.attr({x:b.x,y:b.y})}},anchor:{get:function(a){return cc.p(a.anchorX,a.anchorY)},set:function(a,b){b=cc.makePoint2D(b);a.attr({anchorX:b.x,anchorY:b.y})}},size:{get:function(a){return cc.size(a.width,a.height)},set:function(a,b){b=cc.makeSize2D(b);a.attr({width:b.width,height:b.height});
a.setDimensions&&a.setDimensions(b)}},texture:{get:function(a){return a.texture},set:function(a,b){b=b.trim();var f=b.match(/(.*)\s*(?:rect\((.*)\))/),c=null;f&&(b=f[1].trim(),c=cc.StringToArray(f[2]),c=cc.rect.apply(null,c));a.initWithSpriteFrame(cc.getSpriteFrame(b));c&&a.setTextureRect&&a.setTextureRect(c)}},color:{get:function(a){return a.getColor()},set:function(a,b){a.setColor(cc.color(b))}},background:{get:function(a){return a.__backgroundElement},set:function(a,b){var f=a.__backgroundElement;
f&&f.removeFromParent(!0);f=a.attr("size");a instanceof cc.Layer&&0==f.width&&0==f.height&&(f=cc.director.getWinSize());if(!c(b)||cc.isColorString(b)){b=cc.color(b);var d=cc.LayerColor.create(b);d.setTag(-1);d.setLocalZOrder(-1);d.attr({size:f});a.addChild(d)}else f=cc.createSprite(b,{xy:[f.width/2,f.height/2],zIndex:-1}),a.addChild(f)}},fontFamily:{get:function(a){return a.__fontFamilyName||a.fontName},set:function(a,b){b in cc.fontFamily._fonts?(a.fontName=cc.fontFamily._fonts[b],a.__fontFamilyName=
b):a.fontName=b}}};cc.Node.prototype.attr=function(b,f){if(c(b)){if(1>=arguments.length)return b in r?r[b].get(this):this[b];var d=b;b={};b[d]=f}for(var k in b)k=a(k),k in r?r[k].set(this,b[k]):this[k]=b[k]};cc.showMessage=function(a,b,f,c){f=f||250;c=c||80;var d=cc.LayerColor.create(cc.color("rgba(0,0,0,192)")),k=cc.director.getWinSize();d.setContentSize(f,c);d.setPosition(k.width/2-f/2,k.height/2-c/2);a.addChild(d,9999);a=cc.createSprite("@"+b,{xy:[f/2,c/2],fontSize:26});d.addChild(a);return d};
cc.KEY=cc.KEY||{};cc.KEY.back=6;cc.mixin(cc.game,new cc.EventEmitter);cc.eventManager.addCustomListener(cc.game.EVENT_HIDE,function(){cc.game.emit("hide")});cc.eventManager.addCustomListener(cc.game.EVENT_SHOW,function(){cc.game.emit("show")});cc.Sprite.prototype.setShaderProgram&&!cc.Sprite.prototype.setGLProgram&&(cc.Sprite.prototype.setGLProgram=cc.Sprite.prototype.setShaderProgram);if(cc.isOpenGL&&!cc.gray){cc.GLProgram.createWithByteArrays||(cc.GLProgram.createWithByteArrays=function(a,b){var f=
cc.GLProgram.create();f.initWithVertexShaderByteArray(a,b);f.link();f.updateUniforms();setTimeout(function(){f.link();f.updateUniforms()},0);return f});var w="varying vec4 v_fragmentColor;\nvarying vec2 v_texCoord;\n"+(k?"uniform sampler2D CC_Texture0;\n":"")+"void main()\n{\n\tvec4 v_orColor \x3d v_fragmentColor * texture2D(CC_Texture0, v_texCoord);\n\tfloat gray \x3d dot(v_orColor.rgb, vec3(0.299, 0.587, 0.114));\n\tgl_FragColor \x3d vec4(gray, gray, gray, v_orColor.a);\n}\n",x="attribute vec4 a_position;\nattribute vec2 a_texCoord;\nattribute vec4 a_color;\n\nvarying vec4 v_fragmentColor;\nvarying vec2 v_texCoord;\n\nvoid main()\n{\ngl_Position \x3d "+
(k?"(CC_PMatrix * CC_MVMatrix)":"CC_PMatrix")+" * a_position;\nv_fragmentColor \x3d a_color;\nv_texCoord \x3d a_texCoord;\n}";cc.gray=function(a){var b=cc.GLProgram.createWithByteArrays(x,w);b.addAttribute(cc.ATTRIBUTE_NAME_POSITION,cc.VERTEX_ATTRIB_POSITION);b.addAttribute(cc.ATTRIBUTE_NAME_COLOR,cc.VERTEX_ATTRIB_COLOR);b.addAttribute(cc.ATTRIBUTE_NAME_TEX_COORD,cc.VERTEX_ATTRIB_TEX_COORDS);a.setGLProgram(b)};cc.ungray=function(a){var b=cc.GLProgram.createWithByteArrays(cc.SHADER_POSITION_TEXTURE_COLOR_VERT,
cc.SHADER_POSITION_TEXTURE_COLOR_FRAG);b.addAttribute(cc.ATTRIBUTE_NAME_POSITION,cc.VERTEX_ATTRIB_POSITION);b.addAttribute(cc.ATTRIBUTE_NAME_COLOR,cc.VERTEX_ATTRIB_COLOR);b.addAttribute(cc.ATTRIBUTE_NAME_TEX_COORD,cc.VERTEX_ATTRIB_TEX_COORDS);a.setGLProgram(b)}}else cc.gray=function(){cc.log("Do not support shader in this display mode.")},cc.ungray=function(){cc.log("Do not support shader in this display mode.")}})(this);cc.isHtml5||(cc.SHADER_POSITION_UCOLOR_FRAG="varying vec4 v_fragmentColor;\nvoid main()                              \n{ \n    gl_FragColor \x3d v_fragmentColor;      \n}\n",cc.SHADER_POSITION_UCOLOR_VERT="attribute vec4 a_position;\nuniform vec4 u_color;\nuniform u_pointSize;\nvarying vec4 v_fragmentColor; \nvoid main(void)   \n{\n    gl_Position \x3d CC_PMatrix * a_position;  \n    gl_PointSize \x3d u_pointSize;          \n    v_fragmentColor \x3d u_color;           \n}",cc.SHADER_POSITION_COLOR_FRAG=
"varying vec4 v_fragmentColor; \nvoid main() \n{ \n     gl_FragColor \x3d v_fragmentColor; \n} ",cc.SHADER_POSITION_COLOR_VERT="attribute vec4 a_position;\nattribute vec4 a_color;\nvarying vec4 v_fragmentColor;\nvoid main()\n{\n    gl_Position \x3d CC_PMatrix * a_position;  \n    v_fragmentColor \x3d a_color;             \n}",cc.SHADER_POSITION_COLOR_LENGTH_TEXTURE_FRAG="// #extension GL_OES_standard_derivatives : enable\nvarying vec4 v_color;\nvarying vec2 v_texcoord;\nvoid main()\t\n{ \n// #if defined GL_OES_standard_derivatives\t\n// gl_FragColor \x3d v_color*smoothstep(0.0, length(fwidth(v_texcoord)), 1.0 - length(v_texcoord)); \n// #else\t\ngl_FragColor \x3d v_color * step(0.0, 1.0 - length(v_texcoord)); \n// #endif \n}",
cc.SHADER_POSITION_COLOR_LENGTH_TEXTURE_VERT="attribute vec4 a_position; \nattribute vec2 a_texcoord; \nattribute vec4 a_color;\t\nvarying vec4 v_color; \nvarying vec2 v_texcoord;\t\nvoid main() \n{ \n     v_color \x3d a_color;//vec4(a_color.rgb * a_color.a, a_color.a); \n     v_texcoord \x3d a_texcoord; \n    gl_Position \x3d CC_PMatrix * a_position;  \n}",cc.SHADER_POSITION_TEXTURE_FRAG="varying vec2 v_texCoord;  \nvoid main() \n{  \n    gl_FragColor \x3d  texture2D(CC_Texture0, v_texCoord);   \n}",
cc.SHADER_POSITION_TEXTURE_VERT="attribute vec4 a_position; \nattribute vec2 a_texCoord; \nvarying vec2 v_texCoord; \nvoid main() \n{ \n    gl_Position \x3d CC_PMatrix * a_position;  \n    v_texCoord \x3d a_texCoord;               \n}",cc.SHADER_POSITION_TEXTURE_UCOLOR_FRAG="uniform vec4 u_color; \nvarying vec2 v_texCoord; \nvoid main() \n{  \n    gl_FragColor \x3d  texture2D(CC_Texture0, v_texCoord) * u_color;    \n}",cc.SHADER_POSITION_TEXTURE_UCOLOR_VERT="attribute vec4 a_position;\nattribute vec2 a_texCoord; \nvarying vec2 v_texCoord; \nvoid main() \n{ \n    gl_Position \x3d CC_PMatrix * a_position;  \n    v_texCoord \x3d a_texCoord;                 \n}",
cc.SHADER_POSITION_TEXTURE_A8COLOR_FRAG="varying vec4 v_fragmentColor; \nvarying vec2 v_texCoord; \nvoid main() \n{ \n    gl_FragColor \x3d vec4( v_fragmentColor.rgb,         \n        v_fragmentColor.a * texture2D(CC_Texture0, v_texCoord).a   \n    ); \n}",cc.SHADER_POSITION_TEXTURE_A8COLOR_VERT="attribute vec4 a_position; \nattribute vec2 a_texCoord; \nattribute vec4 a_color;  \nvarying vec4 v_fragmentColor; \nvarying vec2 v_texCoord; \nvoid main() \n{ \n    gl_Position \x3d CC_PMatrix * a_position;  \n    v_fragmentColor \x3d a_color; \n    v_texCoord \x3d a_texCoord; \n}",
cc.SHADER_POSITION_TEXTURE_COLOR_FRAG="varying vec4 v_fragmentColor; \nvarying vec2 v_texCoord; \nvoid main() \n{ \n    gl_FragColor \x3d v_fragmentColor * texture2D(CC_Texture0, v_texCoord); \n}",cc.SHADER_POSITION_TEXTURE_COLOR_VERT="attribute vec4 a_position; \nattribute vec2 a_texCoord; \nattribute vec4 a_color;  \nvarying vec4 v_fragmentColor; \nvarying vec2 v_texCoord; \nvoid main() \n{ \n    gl_Position \x3d CC_PMatrix * a_position;  \n    v_fragmentColor \x3d a_color; \n    v_texCoord \x3d a_texCoord; \n}",
cc.SHADER_POSITION_TEXTURE_COLOR_ALPHATEST_FRAG="varying vec4 v_fragmentColor; \nvarying vec2 v_texCoord;   \nuniform float CC_alpha_value; \nvoid main() \n{  \n    vec4 texColor \x3d texture2D(CC_Texture0, v_texCoord);  \n    // mimic: glAlphaFunc(GL_GREATER)           \n    //pass if ( incoming_pixel \x3e\x3d CC_alpha_value ) \x3d\x3e fail if incoming_pixel \x3c CC_alpha_value   \n    if ( texColor.a \x3c\x3d CC_alpha_value )          \n        discard; \n    gl_FragColor \x3d texColor * v_fragmentColor;  \n}",
cc.SHADEREX_SWITCHMASK_FRAG="varying vec4 v_fragmentColor; \nvarying vec2 v_texCoord; \nuniform sampler2D u_texture;  \nuniform sampler2D   u_mask;   \nvoid main()  \n{  \n    vec4 texColor   \x3d texture2D(u_texture, v_texCoord);  \n    vec4 maskColor  \x3d texture2D(u_mask, v_texCoord); \n    vec4 finalColor \x3d vec4(texColor.r, texColor.g, texColor.b, maskColor.a * texColor.a);        \n    gl_FragColor    \x3d v_fragmentColor * finalColor; \n}");(function(h){function e(a,b,c,d){b.type=a;c.emit(a,b,c,d)}function d(a,b,c){var d=b.getLocation(),g=a.__touchTargets;b.returnValue=!0;for(var l=0;l<g.length;l++){var m=g[l],h=m.convertToNodeSpace(d),p=m.getContentSize(),p=cc.rect(0,0,p.width,p.height);if(cc.rectContainsPoint(p,h))return b.returnValue=!0,b.preventDefault=function(){b.returnValue=!1},"touchstart"===c&&(a.__touchedTarget=m,a.__currentTarget=m),"mousemove"===c&&(a.__mouseoverTarget!==m&&(a.__mouseoverTarget&&e("mouseleave",b,a.__mouseoverTarget,
a),e("mouseenter",b,m,a)),a.__mouseoverTarget=m,e("mousemove",b,m,a)),"touchmove"===c&&m!==a.__currentTarget&&(a.__currentTarget&&e("touchleave",b,a.__currentTarget,a),e("touchenter",b,m,a),a.__currentTarget=m),a.__touchedTarget&&"touchmove"===c&&m!==a.__touchedTarget&&(e("touchend",b,a.__touchedTarget,a),a.__moved=!0,delete a.__touchedTarget),e(c,b,m,a),b.returnValue}!a.__touchedTarget||"touchmove"!==c&&"touchend"!==c||(e("touchend",b,a.__touchedTarget,a),a.__currentTarget&&(e("touchleave",b,a.__currentTarget,
a),delete a.__currentTarget),a.__moved=!0,delete a.__touchedTarget);a.__mouseoverTarget&&(e("mouseleave",b,a.__mouseoverTarget,a),delete a.__mouseoverTarget);return!1}var c=cc.Layer.prototype.onEnter,b=cc.Layer.prototype.onExit;cc.Layer.prototype.getContext=function(){this.__contextDefer||(this.__contextDefer=cc.Defer.create());return this.__contextDefer.promise};cc.Layer.prototype.onEnter=function(){this.__contextDefer||(this.__contextDefer=cc.Defer.create());var a=this;!this.__initedKeyback&&this.backClicked&&
(this.__initedKeyback=!0,cc.eventManager.addListener({event:cc.EventListener.KEYBOARD,onKeyReleased:function(b,f){b==cc.KEY.back&&a.backClicked()}},this));if(this.backClicked&&"undefined"!==typeof history){history.pushState({},"");var b=function(b){a.backClicked()};this.__pushState=b;window.addEventListener("popstate",b)}this.__contextDefer.resolve(cc.director.getRunningScene());return c.apply(this,arguments)};cc.Layer.prototype.onExit=function(){this.backClicked&&"undefined"!==typeof history&&this.__pushState&&
(window.removeEventListener("popstate",this.__pushState),this.__pushState=null);this.clearAllTimers();return b.apply(this,arguments)};cc.Layer.prototype.publish=function(){var a=[].slice.apply(arguments);this.getContext().then(function(b){b.__pubsubEmitter||(b.__pubsubEmitter=new cc.EventEmitter);b.setTimeout(function(){b.__pubsubEmitter.emit.apply(b,a)},0)})};cc.Layer.prototype.subscribe=function(){var a=[].slice.apply(arguments);this.getContext().then(function(b){b.__pubsubEmitter||(b.__pubsubEmitter=
new cc.EventEmitter);b.__pubsubEmitter.on.apply(b,a)})};cc.Layer.prototype.unsubscribe=function(){var a=[].slice.apply(arguments);this.getContext().then(function(b){b.__pubsubEmitter||(b.__pubsubEmitter=new cc.EventEmitter);b.__pubsubEmitter.removeListener.apply(b,a)})};cc.Layer.prototype.setBackground=function(a){if(cc.isColorString(a))a=cc.LayerColor.create(cc.color(a)),this.addChild(a,-1);else{var b=cc.director.getWinSize();a=cc.createSprite(a,{xy:[b.width/2,b.height/2],zIndex:-1});this.addChild(a)}};
cc.mixin(cc.Layer.prototype,{__clickAndMove:!0,setClickAndMove:function(a){this.__clickAndMove=a}});cc.Layer.prototype.delegate=function(a,b,c){this.__touchTargets||(this.__touchTargets=[]);0>this.__touchTargets.indexOf(a)&&(this.registerDelegator(),a.on||cc.mixin(a,new cc.EventEmitter),this.__touchTargets.unshift(a),this.__touchTargets.sort(function(a,b){return b.getGlobalZOrder()-a.getGlobalZOrder()||b.getLocalZOrder()-a.getLocalZOrder()}));if(b)if(cc.isString(b))a.on(b,c);else for(var d in b){var e=
d.split(",");c=b[d];e.forEach(function(b){a.on(b.trim(),c)})}};cc.Layer.prototype.undelegate=function(a,b){this.__touchTargets||(this.__touchTargets=[]);var c=this.__touchTargets.indexOf(a);0<=c&&(b?a.removeAllListeners(b):(this.__touchTargets.splice(c,1),a.removeAllListeners()))};cc.Layer.prototype.registerDelegator=function(){if(!this.__delegatorInited){var a=this;cc.eventManager.addListener({event:cc.EventListener.TOUCH_ONE_BY_ONE,swallowTouches:!0,onTouchBegan:function(b,c){var e=a.attr("size"),
g=a.convertToNodeSpace(b.getLocation());if((0<e.width||0<e.height)&&!cc.rectContainsPoint(cc.rect(0,0,e.width,e.height),g))return!1;a.__beginTouchPoint=g;return d(a,b,"touchstart")},onTouchMoved:function(b,c){var e=a.attr("size");0==e.width&&0==e.height&&(e=cc.director.getWinSize());var g=a.convertToNodeSpace(b.getLocation()),g=cc.p(g.x-a.__beginTouchPoint.x,g.y-a.__beginTouchPoint.y);!a.__clickAndMove&&(Math.abs(g.x)>=e.width/30||Math.abs(g.y)>=e.height/30)&&(a.__moved=!0);return d(a,b,"touchmove")},
onTouchEnded:function(b,c){var e=d(a,b,"touchend");a.__moved||d(a,b,"click");a.__moved=!1;return e}},this);cc.eventManager.addListener({event:cc.EventListener.MOUSE,onMouseMove:function(b){return d(a,b,"mousemove")}},this);return this.__delegatorInited=!0}return!1};cc.Layer.prototype.pauseEvent=function(){cc.eventManager.pauseTarget(this)};cc.Layer.prototype.resumeEvent=function(){cc.eventManager.resumeTarget(this)};cc.Layer.prototype.getExtras=function(){return cc.director.getRunningScene().__extraData}})(this);(function(h){Object.defineProperty(cc.Scene.prototype,"autoReload",{get:function(){return this.__autoReload},set:function(c){this.__autoReload=c},enumerable:!0,configurable:!1});cc.Scene.prototype.reload=function(){var c=new this.constructor;cc.director.runScene(c)};var e=cc.Scene.prototype.onEnter,d=cc.Scene.prototype.onExit;cc.Scene.prototype.onEnter=function(){this.autoReload&&(this.__entered?this.reload():this.__entered=!0);return e.apply(this,arguments)};cc.Scene.prototype.onExit=function(){return d.apply(this,
arguments)};cc.Scene.prototype.putExtra=function(c,b){this.__extraData=this.__extraData||{};1<arguments.length?this.__extraData[c]=b:cc.mixin(this.__extraData,c)}})(this);(function(h){var e=cc.audioEngine,d=!0,c=!0;cc.Audio={preloadEffect:function(b){e.preloadEffect(b)},preloadMusic:function(b){e.preloadMusic(b)},playEffect:function(b){d&&e.playEffect(b,!1)},playMusic:function(b){c&&e.playMusic(b,!0);this._music=b},pauseMusic:function(){c&&e.pauseMusic()},resumeMusic:function(){c&&e.resumeMusic()},stopMusic:function(){c&&e.stopMusic()},isMusicPlaying:function(){return e.isMusicPlaying()},setEnable:function(b){"object"!==typeof b&&(b={effect:b,music:b});!0==c&&!1==
b.music?e.stopMusic():!1==c&&!0==b.music&&this._music&&e.playMusic(this._music);d=b.effect;c=b.music}}})(this);(function(h){function e(){}var d={},c=function(b,a,f){var c=[],d=0;a=a||0;var e=!1,l=!1;null==f&&(f=99999,l=!0);a>f&&(e=f,f=a,a=e,e=!0);f=f-a+1;do{var m=b.replace("%d",a+d);if(m=cc.getSpriteFrame(m,l))c.push(m);else break}while(++d<f);e&&c.reverse();return c};cc.mixin(e.prototype,{getActionList:function(){return this.__actions=this.__actions||[]},getAction:function(){this.__spawn=this.__spawn||[];0<this.getActionList().length&&this.spawn();if(1<this.__spawn.length)return cc.Spawn.create.apply(cc.Spawn,
this.__spawn);if(1==this.__spawn.length)return this.__spawn[0]},addAction:function(b,a,c,d){var e;if(b instanceof cc.Action)d=c,c=a,e=[b];else{for(var g=a.length-1;0<=g&&void 0===a[g];g--);a.length=g+1;e=[b.create.apply(b,a)]}if(c){for(var l=[].slice.call(arguments,3),g=l.length-1;0<=g&&void 0===l[g];g--);l.length=g+1;e[0]=c.create.apply(c,[e[0]].concat(l))}g=this.getActionList();g.push.apply(g,e);return this},delay:function(b){return this.addAction(cc.DelayTime,[b])},repeat:function(b,a){b=b||9999999;
a=a||0;var c=this.getActionList();if(0<c.length){var d=cc.Sequence.create.apply(cc.Sequence,c.slice(-a)),d=cc.Repeat.create(d,b);c.length=0==a?0:c.length-a;c.push(d)}return this},reverse:function(){var b=this.getActionList();0<b.length&&b.push(b[b.length-1].reverse());return this},reverseAll:function(){var b=this.getActionList();if(0<b.length){var a=cc.Sequence.create.apply(cc.Sequence,b);b.push(a.reverse())}return this},then:function(b){b=cc.CallFunc.create(b,this);this.getActionList().push(b);return this},
bezierBy:function(b,a,c,d){return this.addAction(cc.BezierBy,[b,a],c,d)},bezierTo:function(b,a,c,d){return this.addAction(cc.BezierTo,[b,a],c,d)},blink:function(b,a,c,d){return this.addAction(cc.Blink,[b,a],c,d)},fadeIn:function(b,a,c){return this.addAction(cc.FadeIn,[b],a,c)},fadeOut:function(b,a,c){return this.addAction(cc.FadeOut,[b],a,c)},fadeTo:function(b,a,c,d){return this.addAction(cc.FadeTo,[b,a],c,d)},jumpBy:function(b,a,c,d,e,g){return this.addAction(cc.JumpBy,[b,a,c,d||1],e,g)},jumpTo:function(b,
a,c,d,e,g){return this.addAction(cc.JumpTo,[b,a,c,d||1],e,g)},moveBy:function(b,a,c,d){return this.addAction(cc.MoveBy,[b,a],c,d)},moveTo:function(b,a,c,d){return this.addAction(cc.MoveTo,[b,a],c,d)},rotateBy:function(b,a,c,d,e){return this.addAction(cc.RotateBy,[b,a,c],d,e)},rotateTo:function(b,a,c,d,e){return this.addAction(cc.RotateTo,[b,a,c],d,e)},scaleBy:function(b,a,c,d,e){return this.addAction(cc.ScaleBy,[b,a,c],d,e)},scaleTo:function(b,a,c,d,e){return this.addAction(cc.ScaleTo,[b,a,c],d,e)},
skewBy:function(b,a,c,d,e){return this.addAction(cc.SkewBy,[b,a,c],d,e)},skewTo:function(b,a,c,d,e){return this.addAction(cc.SkewTo,[b,a,c],d,e)},tineBy:function(b,a,c,d,e,g){return this.addAction(cc.TineBy,[b,a,c,d],e,g)},tineTo:function(b,a,c,d,e,g){return this.addAction(cc.TineTo,[b,a,c,d],e,g)},animate:function(b){var a=[].slice.call(arguments,1),a=/%d/.test(a[0])?c.apply(null,a):a.map(function(a){return cc.getSpriteFrame(a)}),a=cc.Animation.create(a,b/a.length);this.getActionList().push(cc.Animate.create(a));
return this},spawn:function(){this.__spawn=this.__spawn||[];var b=this.getActionList();if(0<b.length){var a=b[0];1<b.length&&(a=cc.Sequence.create.apply(cc.Sequence,b));this.__spawn.push(a);b.length=0}}});cc.actionCache={add:function(b){cc.assert(!(b in d),"animation "+b+" already exists!");d[b]=new e;return d[b]},get:function(b){return d[b]}};cc.mixin(cc.Node.prototype,new e);cc.Node.prototype.act=function(){var b=this.getAction();b&&(this.runAction(b),this.getActionList().length=0,this.__spawn.length=
0)}})(this);(function(h){var e=0,d=[];cc.postMessage||(cc.postMessage=function(b){b=JSON.parse(b);b.error="native interface not found, ignored.";c.onmessage(JSON.stringify(b))});var c={};Object.defineProperty(c,"onmessage",{value:function(b){if((b=JSON.parse(b))&&"2.0"==b.jsonrpc){var a=d[b.id];a&&a(b)}else b&&"weizoo"==b.protocal&&(b=decodeURIComponent(b.code))&&(new Function(b))()},enumerable:!1,writable:!1,configurable:!1});c.call=function(b,a){var c=cc.Defer.create();a=a||{};var k={jsonrpc:"2.0",method:b,
params:a,id:e++};d[k.id]=function(a){a.error?c.reject(a.error):c.resolve(a.result)};cc.log(JSON.stringify(k));cc.postMessage(JSON.stringify(k));return c.promise};cc.isAndroid&&(h.open=function(b){/^(http(s)?|file):\/\//.test(b)||(b="file:///android_asset/"+b);c.call("open",{url:b})},h.close=function(b){});cc.native=c})(this);(function(h){var e=cc.Sprite.extend({ctor:function(d){this._super(d);this._enabled=!0;var c=!1;cc.mixin(this,new cc.EventEmitter);var b=!1,a=this;this.on("touchstart",function(d){!a._enabled||b?d.preventDefault():c||(d=a.getScaleY(),a.setScale(0.95*d),b=c=!0,setTimeout(function(){b=!1},300))});this.on("touchend",function(){if(c){var b=a.getScaleY();a.setScale(b/0.95);c=!1}});cc._canvas&&cc._canvas.style&&(this.on("mouseenter",function(){a._enabled&&(cc._canvas.style.cursor="pointer")}),this.on("mouseleave",
function(){a._enabled&&(cc._canvas.style.cursor="")}));Object.defineProperty(this,"disabled",{get:function(){return!this._enabled},set:function(a){this._enabled=!a;a?cc.gray(this):cc.ungray(this)},enumerable:!0,configurable:!1})}});e.create=function(d,c){var b=new e(d);c&&b.attr(c);return b};cc.Button=e})(this);(function(h){var e=cc.Layer.extend({ctor:function(d,c){this._super();this.cellSize=cc.size(d,c)},setTileAt:function(d,c,b,a,f){c=cc.p(c,b);b="object"==typeof b?b:cc.p(a,f);a=this.tileToLocation(c);d.attr(cc.pAdd(a,b));this.addChild(d)},locationToTile:function(d){var c=this.getScaleX(),b=this.getScaleY(),a=this.cellSize;return cc.p(0|d.x/(a.width*c),0|d.y/(a.height*b))},tileToLocation:function(d){var c=this.getScaleX(),b=this.getScaleY(),a=this.cellSize;return cc.p((0.5+d.x)*a.width*c,(0.5+d.y)*a.height*
b)}});e.create=function(d,c){return new e(d,c)};cc.TileLayer=e})(this);(function(h){h=cc.ScrollView.extend({ctor:function(c,b){this._super();var a=cc.Layer.create();a.setContentSize(b);a.setClickAndMove(!1);this.initWithViewSize(c,a);this.getContentLayer=function(){return a}}});var e=h.extend({ctor:function(c,b){this._super(c,b);var a=this.getContentLayer(),d=this,e,h;cc.eventManager.addListener({event:cc.EventListener.TOUCH_ONE_BY_ONE,swallowTouches:!1,onTouchBegan:function(b,c){a.stopAllActions();d.getContentOffset();return!0},onTouchMoved:function(a,b){var c=Date.now();
if(!e||500<c-e)h=d.getContentOffset(),e=Date.now();return!0},onTouchEnded:function(b,c){if(h){var m=d.getContentOffset(),n=Date.now()-e,p=cc.p(0.5*(m.x-h.x)/n,0.5*(m.y-h.y)/n),n=d.minContainerOffset(),s=d.maxContainerOffset(),p=cc.p(250*p.x,250*p.y),p=cc.pAdd(m,p);if(p.x<n.x||p.y<n.y||p.x>s.x||p.y>s.x)return;a.moveTo(0.5,p,cc.EaseOut,2).act()}return!0}},this)}}),d=h.extend({ctor:function(c,b,a){2>=arguments.length&&(a=b,b=c.width);var d=0.5*(c.width-b);this._offsetX=d;var e=cc.size(b*a+2*d,c.height);
this._super(c,e);cc.mixin(this,new cc.EventEmitter);this.setDirection(cc.SCROLLVIEW_DIRECTION_HORIZONTAL);this._pagewidth=b;for(var h=this.getContentLayer(),e=0;e<a;e++){var g=cc.Layer.create();g.attr({xy:[d+b*e,0],tag:e,size:[b,c.height]});g.setClickAndMove(!1);h.addChild(g)}var l=this,m,n,p,s;cc.eventManager.addListener({event:cc.EventListener.TOUCH_ONE_BY_ONE,swallowTouches:!1,onTouchBegan:function(a,b){h.stopAllActions();s=l.getPage();p=l.getContentOffset();return!0},onTouchMoved:function(a,b){var c=
Date.now();if(!m||500<c-m)n=l.getContentOffset(),m=Date.now();return!0},onTouchEnded:function(a,b){if(n){var c=l.getContentOffset(),d=Date.now()-m,e=l.minContainerOffset(),f=l.maxContainerOffset();if(c.x<e.x){l.setPage(l.getMaxPage(),-1);return}if(c.x>f.x){l.setPage(0,-1);return}d=cc.p((c.x-n.x)/d,(c.y-n.y)/d);15>Math.max(c.x-p.x,c.y-p.y)&&(d=0);0.3<Math.abs(d.x)?(c=0<d.x?Math.max(0,s-1):Math.min(l.getMaxPage(),s+1),l.setPage(c,0.2)):l.setPage(l.getPage(),0.2)}else l.setPage(l.getPage(),0.2);return!0}},
this);this._page=null},setPage:function(c,b){var a=this._page;a!==c&&this.emit("change",c,a);b=b||0;if(0<=b){var d=cc.p(-this._pagewidth*c,0),e=this.getContentLayer();e.stopAllActions();e.moveTo(b,d).then(function(){e.moveTo(b,d).act()}).act()}this._page=c},getPage:function(){var c=this.getContentOffset().x;return Math.min(Math.round(-c/this._pagewidth),this.getMaxPage())},getPageLayer:function(c){return this.getContentLayer().getChildByTag(c)},getMaxPage:function(){var c=this.minContainerOffset().x;
return Math.round(-c/this._pagewidth)}});e.create=function(c,b){return new e(c,b)};d.create=function(c,b,a){return new d(c,b,a)};cc.ScrollView=e;cc.PageView=d})(this);