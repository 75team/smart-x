(function(h){var f,e,d;(function(){var b={},a={};f=function(a,g,d){b[a]={deps:g,callback:d}};d=e=function(c){function g(a){if("."!==a.charAt(0))return a;a=a.split("/");for(var b=c.split("/").slice(0,-1),g=0,d=a.length;g<d;g++){var l=a[g];".."===l?b.pop():"."!==l&&b.push(l)}return b.join("/")}d._eak_seen=b;if(a[c])return a[c];a[c]={};if(!b[c])throw Error("Could not find module "+c);for(var r=b[c],s=r.deps,r=r.callback,f=[],k,n=0,h=s.length;n<h;n++)"exports"===s[n]?f.push(k={}):f.push(e(g(s[n])));s=
r.apply(this,f);return a[c]=k||s}})();f("promise/all",["./utils","exports"],function(b,a){var c=b.isArray,g=b.isFunction;a.all=function(a){if(!c(a))throw new TypeError("You must pass an array to all.");return new this(function(b,c){function d(a){return function(c){e[a]=c;0===--f&&b(e)}}var e=[],f=a.length,h;0===f&&b([]);for(var p=0;p<a.length;p++)(h=a[p])&&g(h.then)?h.then(d(p),c):(e[p]=h,0===--f&&b(e))})}});f("promise/asap",["exports"],function(b){function a(){return function(){process.nextTick(d)}}
function c(){var a=0,b=new f(d),c=document.createTextNode("");b.observe(c,{characterData:!0});return function(){c.data=a=++a%2}}function g(){return function(){k.setTimeout(d,1)}}function d(){for(var a=0;a<n.length;a++){var b=n[a];(0,b[0])(b[1])}n=[]}var e="undefined"!==typeof window?window:{},f=e.MutationObserver||e.WebKitMutationObserver,k="undefined"!==typeof h?h:void 0===this?window:this,n=[],q;q="undefined"!==typeof process&&"[object process]"==={}.toString.call(process)?a():f?c():g();b.asap=
function(a,b){1===n.push([a,b])&&q()}});f("promise/config",["exports"],function(b){var a={instrument:!1};b.config=a;b.configure=function(b,g){if(2===arguments.length)a[b]=g;else return a[b]}});f("promise/polyfill",["./promise","./utils","exports"],function(b,a,c){var g=b.Promise,d=a.isFunction;c.polyfill=function(){var a;a="undefined"!==typeof h?h:"undefined"!==typeof window&&window.document?window:self;"Promise"in a&&"resolve"in a.Promise&&"reject"in a.Promise&&"all"in a.Promise&&"race"in a.Promise&&
function(){var b;new a.Promise(function(a){b=a});return d(b)}()||(a.Promise=g)}});f("promise/promise","./config ./utils ./all ./race ./resolve ./reject ./asap exports".split(" "),function(b,a,c,g,d,e,f,k){function h(a){if(!z(a))throw new TypeError("You must pass a resolver function as the first argument to the promise constructor");if(!(this instanceof h))throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.");this._subscribers=
[];q(a,this)}function q(a,b){function c(a){l(b,a)}function g(a){t(b,a)}try{a(c,g)}catch(d){g(d)}}function u(a,b,c,g){var d=z(c),m,e,f,r;if(d)try{m=c(g),f=!0}catch(s){r=!0,e=s}else m=g,f=!0;w(b,m)||(d&&f?l(b,m):r?t(b,e):a===A?l(b,m):a===B&&t(b,m))}function p(a,b,l,c){a=a._subscribers;var g=a.length;a[g]=b;a[g+A]=l;a[g+B]=c}function v(a,b){for(var l,c,g=a._subscribers,d=a._detail,m=0;m<g.length;m+=3)l=g[m],c=g[m+b],u(b,l,c,d);a._subscribers=null}function w(a,b){var c=null,g;try{if(a===b)throw new TypeError("A promises callback cannot return that same promise.");
if(E(b)&&(c=b.then,z(c)))return c.call(b,function(c){if(g)return!0;g=!0;b!==c?l(a,c):m(a,c)},function(b){if(g)return!0;g=!0;t(a,b)}),!0}catch(d){if(g)return!0;t(a,d);return!0}return!1}function l(a,b){a===b?m(a,b):w(a,b)||m(a,b)}function m(a,b){a._state===C&&(a._state=D,a._detail=b,y.async(F,a))}function t(a,b){a._state===C&&(a._state=D,a._detail=b,y.async(G,a))}function F(a){v(a,a._state=A)}function G(a){v(a,a._state=B)}var y=b.config,E=a.objectOrFunction,z=a.isFunction;b=c.all;g=g.race;d=d.resolve;
e=e.reject;y.async=f.asap;var C=void 0,D=0,A=1,B=2;h.prototype={constructor:h,_state:void 0,_detail:void 0,_subscribers:void 0,then:function(a,b){var l=this,c=new this.constructor(function(){});if(this._state){var g=arguments;y.async(function(){u(l._state,c,g[l._state-1],l._detail)})}else p(this,c,a,b);return c},"catch":function(a){return this.then(null,a)}};h.all=b;h.race=g;h.resolve=d;h.reject=e;k.Promise=h});f("promise/race",["./utils","exports"],function(b,a){var c=b.isArray;a.race=function(a){if(!c(a))throw new TypeError("You must pass an array to race.");
return new this(function(b,c){for(var d,e=0;e<a.length;e++)(d=a[e])&&"function"===typeof d.then?d.then(b,c):b(d)})}});f("promise/reject",["exports"],function(b){b.reject=function(a){return new this(function(b,g){g(a)})}});f("promise/resolve",["exports"],function(b){b.resolve=function(a){return a&&"object"===typeof a&&a.constructor===this?a:new this(function(b){b(a)})}});f("promise/utils",["exports"],function(b){function a(a){return"function"===typeof a}var c=Date.now||function(){return(new Date).getTime()};
b.objectOrFunction=function(b){return a(b)||"object"===typeof b&&null!==b};b.isFunction=a;b.isArray=function(a){return"[object Array]"===Object.prototype.toString.call(a)};b.now=c});e("promise/polyfill").polyfill();cc.Promise=Promise;cc.Defer=function(){var b=this;this.promise=new Promise(function(a,c){b.resolve=a;b.reject=c})};cc.Defer.create=function(){return new cc.Defer}})(this);(function(h){function f(){this._events=this._events||{};this._maxListeners=this._maxListeners||void 0}f.EventEmitter=f;f.prototype._events=void 0;f.prototype._maxListeners=void 0;f.defaultMaxListeners=10;f.prototype.setMaxListeners=function(e){if(!cc.isNumber(e)||0>e||isNaN(e))throw TypeError("n must be a positive number");this._maxListeners=e;return this};f.prototype.emit=function(e){var d,b,a,c;this._events||(this._events={});if("error"===e&&!this._events.error){d=arguments[1];if(d instanceof Error)throw d;
throw Error('Uncaught, unspecified "error" event.');}b=this._events[e];if(cc.isUndefined(b))return!1;if(cc.isFunction(b))switch(arguments.length){case 1:b.call(this);break;case 2:b.call(this,arguments[1]);break;case 3:b.call(this,arguments[1],arguments[2]);break;default:d=arguments.length;a=Array(d-1);for(c=1;c<d;c++)a[c-1]=arguments[c];b.apply(this,a)}else if(cc.isObject(b)){d=arguments.length;a=Array(d-1);for(c=1;c<d;c++)a[c-1]=arguments[c];b=b.slice();d=b.length;for(c=0;c<d;c++)b[c].apply(this,
a)}return!0};f.prototype.addListener=function(e,d){var b;if(!cc.isFunction(d))throw TypeError("listener must be a function");this._events||(this._events={});this._events.newListener&&this.emit("newListener",e,cc.isFunction(d.listener)?d.listener:d);this._events[e]?cc.isObject(this._events[e])?this._events[e].push(d):this._events[e]=[this._events[e],d]:this._events[e]=d;cc.isObject(this._events[e])&&!this._events[e].warned&&(b=cc.isUndefined(this._maxListeners)?f.defaultMaxListeners:this._maxListeners)&&
0<b&&this._events[e].length>b&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),console.trace());return this};f.prototype.on=f.prototype.addListener;f.prototype.once=function(e,d){function b(){this.removeListener(e,b);a||(a=!0,d.apply(this,arguments))}if(!cc.isFunction(d))throw TypeError("listener must be a function");var a=!1;b.listener=d;this.on(e,b);
return this};f.prototype.removeListener=function(e,d){var b,a,c;if(!cc.isFunction(d))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;b=this._events[e];c=b.length;a=-1;if(b===d||cc.isFunction(b.listener)&&b.listener===d)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,d);else if(cc.isObject(b)){for(;0<c--;)if(b[c]===d||b[c].listener&&b[c].listener===d){a=c;break}if(0>a)return this;1===b.length?(b.length=0,delete this._events[e]):
b.splice(a,1);this._events.removeListener&&this.emit("removeListener",e,d)}return this};f.prototype.removeAllListeners=function(e){var d;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(d in this._events)"removeListener"!==d&&this.removeAllListeners(d);this.removeAllListeners("removeListener");this._events={};return this}d=this._events[e];if(cc.isFunction(d))this.removeListener(e,
d);else if(Array.isArray(d))for(;d.length;)this.removeListener(e,d[d.length-1]);delete this._events[e];return this};f.prototype.listeners=function(e){return this._events&&this._events[e]?cc.isFunction(this._events[e])?[this._events[e]]:this._events[e].slice():[]};f.listenerCount=function(e,d){return e._events&&e._events[d]?cc.isFunction(e._events[d])?1:e._events[d].length:0};cc.EventEmitter=f})(this);(function(h){function f(a,b,c,d,e,f){g?setTimeout(function(){cc.director.getScheduler().scheduleCallbackForTarget(a,b,c/1E3,d,e,f)},0):(cc.director.getScheduler().unscheduleCallbackForTarget(a,b),cc.director.getScheduler().scheduleCallbackForTarget(a,b,c/1E3,d,e,f));x.push(b);return x.length-1}function e(a){return Array.isArray(a)}function d(a){return"string"===typeof a}function b(a){return"object"===typeof a&&null!==a}function a(a){return a.replace(/\-(\w)/ig,function(a,b){return b.toUpperCase()})}
h.console||(h.console={log:cc.log,error:cc.log,trace:cc.log,warn:cc.log});"undefined"==typeof navigator&&(cc.navigator?h.navigator=cc.navigator:(h.navigator={},navigator.userAgent="Cocos2dx Mac OSX"));var c=0<=navigator.userAgent.indexOf("Mac OSX"),g=0>navigator.userAgent.indexOf("Cocos2dx"),r=0<=navigator.userAgent.indexOf("Android"),s=0<=navigator.userAgent.indexOf("iOS");cc.isOSX=c;cc.isHtml5=g;cc.isAndroid=r;cc.isIOS=s;cc.isOpenGL=cc.sys.capabilities.opengl;cc.isOpenGL||(cc.TransitionCrossFade=
cc.TransitionFadeBL=cc.TransitionFadeTR=cc.TransitionFade);var x=[null];cc.Node.prototype.setTimeout=function(a,b){return f(this||h,a,b||0,0,0,!1)};cc.Node.prototype.setInterval=function(a,b){return f(this||h,a,b||0,cc.REPEAT_FOREVER,0,!1)};cc.Node.prototype.clearAllTimers=function(){var a=this||h;cc.director.getScheduler().unscheduleAllCallbacksForTarget(a)};cc.Node.prototype.clearInterval=cc.Node.prototype.clearTimeout=function(a){var b=this||h,c=x[a];null!=c&&(cc.director.getScheduler().unscheduleCallbackForTarget(b,
c),x[a]=null)};cc.mixin=function(a,b,c){c=c||function(a,b){if("undefined"===typeof a)return b};!0==c&&(c=function(a,b){return b});for(var g in b){var d=c(a[g],b[g],g,a,b);"undefined"!==typeof d&&(a[g]=d)}return a};cc.isArray=e;cc.isBoolean=function(a){return"boolean"===typeof a};cc.isNull=function(a){return null===a};cc.isNullOrUndefined=function(a){return null==a};cc.isNumber=function(a){return"number"===typeof a};cc.isString=d;cc.isSymbol=function(a){return"symbol"===typeof a};cc.isUndefined=function(a){return void 0===
a};cc.isRegExp=function(a){return b(a)&&"[object RegExp]"===objectToString(a)};cc.isObject=b;cc.isDate=function(a){return b(a)&&"[object Date]"===objectToString(a)};cc.isError=function(a){return b(a)&&("[object Error]"===objectToString(a)||a instanceof Error)};cc.isFunction=function(a){return"function"===typeof a};cc.random=function(a,b){if("number"===typeof a)return b=b||0,0|a+Math.random()*(b-a);if(a instanceof Array){var c=a.length;return null==b?a[0|Math.random()*c]:cc.arrayShuffle(a.slice(0)).slice(0,
b)}return Math.random()};cc.tmpl=function(a,b,c){return a=a.replace(/\{([^\{\}]*)\}/g,function(a,l){if(!l)return"";try{var g=(new Function("data","with(data){return ("+l+");}"))(b);return c?c(g,l):g}catch(d){return a}})};cc.arrayShuffle=function(a){for(var b=a.length-1;0<b;b--){var c=0|Math.random()*(b+1),g=a[b];a[b]=a[c];a[c]=g}return a};cc.StringToArray||(cc.StringToArray=function(a){return a.trim().split(/\s*,\s*/).map(function(a){return parseInt(a)})});var k={aqua:"#00FFFF",black:"#000000",blue:"#0000FF",
fuchsia:"#00ff00",grey:"#808080",gray:"#808080",green:"#008000",lime:"#00FF00",maroon:"#800000",navy:"#000080",olive:"#808000",purple:"#800080",red:"#FF0000",silver:"#C0C0C0",teal:"#008080",white:"#FFFFFF",yellow:"#FFFF00"},n=/^aqua$|^black$|^blue$|^fuchsia$|^grey|^gray$|^green$|^lime$|^maroon$|^navy$|^olive$|^purple$|^red$|^silver$|^teal$|^white$|^yellow$|^rgb\(.*?\)$|^rgba\(.*?\)$|^#[0-9a-fA-F]{3}$|^#[0-9a-fA-F]{6}$/;cc.isColorString=function(a){a=a.trim();return n.test(a)};if(!g){var q=cc.color;
cc.color=function(){var a=q.apply(cc,arguments);null==a.a&&(a.a=255);return a}}var u=cc.hexToColor;cc.hexToColor=function(a){a=a.trim();if("#"===a[0])4===a.length&&(a=a.replace(/([^#])/g,"$1$1"));else{if("transparent"==a)return cc.color(0,0,0,0);if(/^rgba?\(/.test(a))return a=a.replace(/^rgba?\(/,""),a=cc.StringToArray(a),4>a.length&&(a[3]=255),cc.color.apply(null,a);a=k[a]}a=u(a);null==a.a&&(a.a=255);return a};cc.fontFamily={_fonts:{},add:function(a,b){this._fonts[a]=b}};cc.textureCache.getTextureForKey||
(cc.textureCache.getTextureForKey=cc.textureCache.textureForKey);cc.getSpriteFrame=function(a,b){var c=cc.spriteFrameCache.getSpriteFrame(a);if(!b&&!c){var d=cc.textureCache.getTextureForKey(a);d||(d=cc.textureCache.addImage(a));!d||g&&!d._isLoaded||(c=d.getContentSize(),c=cc.SpriteFrame.create(d,cc.rect(0,0,c.width,c.height)))}return c};cc.createSprite=function(a,b){"object"!==typeof a||a instanceof cc.Sprite||null!=b||(b=a,a.texture?(a=a.texture,delete b.texture):a=cc.Sprite.create());b=b||{};if("string"===
typeof a)if("@"===a[0])a=cc.LabelTTF.create(a.slice(1));else if(/\.plist$/.test(a))a=cc.ParticleSystem.create(a);else{var c=cc.getSpriteFrame(a);a=cc.Sprite.create();c&&a.initWithSpriteFrame(c)}a.setCascadeOpacityEnabled&&a.setCascadeOpacityEnabled(!0);a.attr(b);return a};cc.makePoint2D=function(a){return e(a)?cc.p(a[0],a[1]):cc.p(a.x,a.y)};cc.makeSize2D=function(a){return e(a)?cc.size(a[0],a[1]):cc.size(a.width,a.height)};g||(cc.LabelTTF.prototype.setColor=function(a){this.getChildren()[0].setColor(a)},
cc.LabelTTF.prototype.getColor=function(){return this.getChildren()[0].getColor()});cc.Node.prototype._attr=cc.Node.prototype.attr;var p={xy:{get:function(a){return cc.p(a.x,a.y)},set:function(a,b){b=cc.makePoint2D(b);a.attr({x:b.x,y:b.y})}},anchor:{get:function(a){return cc.p(a.anchorX,a.anchorY)},set:function(a,b){b=cc.makePoint2D(b);a.attr({anchorX:b.x,anchorY:b.y})}},size:{get:function(a){return cc.size(a.width,a.height)},set:function(a,b){b=cc.makeSize2D(b);a.attr({width:b.width,height:b.height});
a.setDimensions&&a.setDimensions(b)}},texture:{get:function(a){return a.texture},set:function(a,b){b=b.trim();var c=b.match(/(.*)\s*(?:rect\((.*)\))/),g=null;c&&(b=c[1].trim(),g=cc.StringToArray(c[2]),g=cc.rect.apply(null,g));a.initWithSpriteFrame(cc.getSpriteFrame(b));g&&a.setTextureRect&&a.setTextureRect(g)}},color:{get:function(a){return a.getColor()},set:function(a,b){a.setColor(cc.color(b))}},background:{get:function(a){return a.__backgroundElement},set:function(a,b){var c=a.__backgroundElement;
c&&c.removeFromParent(!0);c=a.attr("size");a instanceof cc.Layer&&0==c.width&&0==c.height&&(c=cc.director.getWinSize());if(!d(b)||cc.isColorString(b)){b=cc.color(b);var g=cc.LayerColor.create(b);g.setTag(-1);g.setLocalZOrder(-1);g.attr({size:c});a.addChild(g)}else c=cc.createSprite(b,{xy:[c.width/2,c.height/2],zIndex:-1}),a.addChild(c)}},fontFamily:{get:function(a){return a.__fontFamilyName||a.fontName},set:function(a,b){b in cc.fontFamily._fonts?(a.fontName=cc.fontFamily._fonts[b],a.__fontFamilyName=
b):a.fontName=b}}};cc.Node.prototype.attr=function(b,c){if(d(b)){if(1>=arguments.length)return b in p?p[b].get(this):this[b];var g=b;b={};b[g]=c}for(var e in b)e=a(e),e in p?p[e].set(this,b[e]):this[e]=b[e]};cc.showMessage=function(a,b,c,g){c=c||250;g=g||80;var d=cc.LayerColor.create(cc.color("rgba(0,0,0,192)")),e=cc.director.getWinSize();d.setContentSize(c,g);d.setPosition(e.width/2-c/2,e.height/2-g/2);a.addChild(d,9999);a=cc.createSprite("@"+b,{xy:[c/2,g/2],fontSize:26});d.addChild(a);return d};
cc.KEY=cc.KEY||{};cc.KEY.back=6;cc.mixin(cc.game,new cc.EventEmitter);cc.eventManager.addCustomListener(cc.game.EVENT_HIDE,function(){cc.game.emit("hide")});cc.eventManager.addCustomListener(cc.game.EVENT_SHOW,function(){cc.game.emit("show")});cc.Sprite.prototype.setShaderProgram&&!cc.Sprite.prototype.setGLProgram&&(cc.Sprite.prototype.setGLProgram=cc.Sprite.prototype.setShaderProgram);if(cc.isOpenGL&&!cc.gray){cc.GLProgram.createWithByteArrays||(cc.GLProgram.createWithByteArrays=function(a,b){var c=
cc.GLProgram.create();c.initWithVertexShaderByteArray(a,b);c.link();c.updateUniforms();setTimeout(function(){c.link();c.updateUniforms()},0);return c});var v="varying vec4 v_fragmentColor;\nvarying vec2 v_texCoord;\n"+(g?"uniform sampler2D CC_Texture0;\n":"")+"void main()\n{\n\tvec4 v_orColor \x3d v_fragmentColor * texture2D(CC_Texture0, v_texCoord);\n\tfloat gray \x3d dot(v_orColor.rgb, vec3(0.299, 0.587, 0.114));\n\tgl_FragColor \x3d vec4(gray, gray, gray, v_orColor.a);\n}\n",w="attribute vec4 a_position;\nattribute vec2 a_texCoord;\nattribute vec4 a_color;\n\nvarying vec4 v_fragmentColor;\nvarying vec2 v_texCoord;\n\nvoid main()\n{\ngl_Position \x3d "+
(g?"(CC_PMatrix * CC_MVMatrix)":"CC_PMatrix")+" * a_position;\nv_fragmentColor \x3d a_color;\nv_texCoord \x3d a_texCoord;\n}";cc.gray=function(a){var b=cc.GLProgram.createWithByteArrays(w,v);b.addAttribute(cc.ATTRIBUTE_NAME_POSITION,cc.VERTEX_ATTRIB_POSITION);b.addAttribute(cc.ATTRIBUTE_NAME_COLOR,cc.VERTEX_ATTRIB_COLOR);b.addAttribute(cc.ATTRIBUTE_NAME_TEX_COORD,cc.VERTEX_ATTRIB_TEX_COORDS);a.setGLProgram(b)};cc.ungray=function(a){var b=cc.GLProgram.createWithByteArrays(cc.SHADER_POSITION_TEXTURE_COLOR_VERT,
cc.SHADER_POSITION_TEXTURE_COLOR_FRAG);b.addAttribute(cc.ATTRIBUTE_NAME_POSITION,cc.VERTEX_ATTRIB_POSITION);b.addAttribute(cc.ATTRIBUTE_NAME_COLOR,cc.VERTEX_ATTRIB_COLOR);b.addAttribute(cc.ATTRIBUTE_NAME_TEX_COORD,cc.VERTEX_ATTRIB_TEX_COORDS);a.setGLProgram(b)}}else cc.gray=function(){cc.log("Do not support shader in this display mode.")},cc.ungray=function(){cc.log("Do not support shader in this display mode.")}})(this);(function(h){function f(a,b,g,d){b.type=a;g.emit(a,b,g,d)}function e(a,b,g){var d=b.getLocation(),e=a.__touchTargets;b.returnValue=!0;for(var h=0;h<e.length;h++){var k=e[h],n=k.convertToNodeSpace(d),q=k.getContentSize(),q=cc.rect(0,0,q.width,q.height);if(cc.rectContainsPoint(q,n))return b.returnValue=!0,b.preventDefault=function(){b.returnValue=!1},"touchstart"===g&&(a.__touchedTarget=k,a.__currentTarget=k),"mousemove"===g&&(a.__mouseoverTarget!==k&&(a.__mouseoverTarget&&f("mouseleave",b,a.__mouseoverTarget,
a),f("mouseenter",b,k,a)),a.__mouseoverTarget=k,f("mousemove",b,k,a)),"touchmove"===g&&k!==a.__currentTarget&&(a.__currentTarget&&f("touchleave",b,a.__currentTarget,a),f("touchenter",b,k,a),a.__currentTarget=k),a.__touchedTarget&&"touchmove"===g&&k!==a.__touchedTarget&&(f("touchend",b,a.__touchedTarget,a),a.__moved=!0,delete a.__touchedTarget),f(g,b,k,a),b.returnValue}!a.__touchedTarget||"touchmove"!==g&&"touchend"!==g||(f("touchend",b,a.__touchedTarget,a),a.__currentTarget&&(f("touchleave",b,a.__currentTarget,
a),delete a.__currentTarget),a.__moved=!0,delete a.__touchedTarget);a.__mouseoverTarget&&(f("mouseleave",b,a.__mouseoverTarget,a),delete a.__mouseoverTarget);return!1}var d=cc.Layer.prototype.onEnter,b=cc.Layer.prototype.onExit;cc.Layer.prototype.getContext=function(){this.__contextDefer||(this.__contextDefer=cc.Defer.create());return this.__contextDefer.promise};cc.Layer.prototype.onEnter=function(){this.__contextDefer||(this.__contextDefer=cc.Defer.create());var a=this;!this.__initedKeyback&&this.backClicked&&
(this.__initedKeyback=!0,cc.eventManager.addListener({event:cc.EventListener.KEYBOARD,onKeyReleased:function(b,c){b==cc.KEY.back&&a.backClicked()}},this));if(this.backClicked&&"undefined"!==typeof history){history.pushState({},"");var b=function(b){a.backClicked()};this.__pushState=b;window.addEventListener("popstate",b)}this.__contextDefer.resolve(cc.director.getRunningScene());return d.apply(this,arguments)};cc.Layer.prototype.onExit=function(){this.backClicked&&"undefined"!==typeof history&&this.__pushState&&
(window.removeEventListener("popstate",this.__pushState),this.__pushState=null);this.clearAllTimers();return b.apply(this,arguments)};cc.Layer.prototype.publish=function(){var a=[].slice.apply(arguments);this.getContext().then(function(b){b.__pubsubEmitter||(b.__pubsubEmitter=new cc.EventEmitter);b.setTimeout(function(){b.__pubsubEmitter.emit.apply(b,a)},0)})};cc.Layer.prototype.subscribe=function(){var a=[].slice.apply(arguments);this.getContext().then(function(b){b.__pubsubEmitter||(b.__pubsubEmitter=
new cc.EventEmitter);b.__pubsubEmitter.on.apply(b,a)})};cc.Layer.prototype.unsubscribe=function(){var a=[].slice.apply(arguments);this.getContext().then(function(b){b.__pubsubEmitter||(b.__pubsubEmitter=new cc.EventEmitter);b.__pubsubEmitter.removeListener.apply(b,a)})};cc.Layer.prototype.setBackground=function(a){if(cc.isColorString(a))a=cc.LayerColor.create(cc.color(a)),this.addChild(a,-1);else{var b=cc.director.getWinSize();a=cc.createSprite(a,{xy:[b.width/2,b.height/2],zIndex:-1});this.addChild(a)}};
cc.mixin(cc.Layer.prototype,{__clickAndMove:!0,setClickAndMove:function(a){this.__clickAndMove=a}});cc.Layer.prototype.delegate=function(a,b,g){this.__touchTargets||(this.__touchTargets=[]);0>this.__touchTargets.indexOf(a)&&(this.registerDelegator(),a.on||cc.mixin(a,new cc.EventEmitter),this.__touchTargets.unshift(a),this.__touchTargets.sort(function(a,b){return b.getGlobalZOrder()-a.getGlobalZOrder()||b.getLocalZOrder()-a.getLocalZOrder()}));if(b)if(cc.isString(b))a.on(b,g);else for(var d in b){var e=
d.split(",");g=b[d];e.forEach(function(b){a.on(b.trim(),g)})}};cc.Layer.prototype.undelegate=function(a,b){this.__touchTargets||(this.__touchTargets=[]);var g=this.__touchTargets.indexOf(a);0<=g&&(b?a.removeAllListeners(b):(this.__touchTargets.splice(g,1),a.removeAllListeners()))};cc.Layer.prototype.registerDelegator=function(){if(!this.__delegatorInited){var a=this;cc.eventManager.addListener({event:cc.EventListener.TOUCH_ONE_BY_ONE,swallowTouches:!0,onTouchBegan:function(b,g){var d=a.attr("size"),
f=a.convertToNodeSpace(b.getLocation());if((0<d.width||0<d.height)&&!cc.rectContainsPoint(cc.rect(0,0,d.width,d.height),f))return!1;a.__beginTouchPoint=f;return e(a,b,"touchstart")},onTouchMoved:function(b,d){var f=a.attr("size");0==f.width&&0==f.height&&(f=cc.director.getWinSize());var h=a.convertToNodeSpace(b.getLocation()),h=cc.p(h.x-a.__beginTouchPoint.x,h.y-a.__beginTouchPoint.y);!a.__clickAndMove&&(Math.abs(h.x)>=f.width/30||Math.abs(h.y)>=f.height/30)&&(a.__moved=!0);return e(a,b,"touchmove")},
onTouchEnded:function(b,d){var f=e(a,b,"touchend");a.__moved||e(a,b,"click");a.__moved=!1;return f}},this);cc.eventManager.addListener({event:cc.EventListener.MOUSE,onMouseMove:function(b){return e(a,b,"mousemove")}},this);return this.__delegatorInited=!0}return!1};cc.Layer.prototype.pauseEvent=function(){cc.eventManager.pauseTarget(this)};cc.Layer.prototype.resumeEvent=function(){cc.eventManager.resumeTarget(this)};cc.Layer.prototype.getExtras=function(){return cc.director.getRunningScene().__extraData}})(this);(function(h){Object.defineProperty(cc.Scene.prototype,"autoReload",{get:function(){return this.__autoReload},set:function(d){this.__autoReload=d},enumerable:!0,configurable:!1});cc.Scene.prototype.reload=function(){var d=new this.constructor;cc.director.runScene(d)};var f=cc.Scene.prototype.onEnter,e=cc.Scene.prototype.onExit;cc.Scene.prototype.onEnter=function(){this.autoReload&&(this.__entered?this.reload():this.__entered=!0);return f.apply(this,arguments)};cc.Scene.prototype.onExit=function(){return e.apply(this,
arguments)};cc.Scene.prototype.putExtra=function(d,b){this.__extraData=this.__extraData||{};1<arguments.length?this.__extraData[d]=b:cc.mixin(this.__extraData,d)}})(this);(function(h){var f=cc.audioEngine,e=!0,d=!0;cc.Audio={preloadEffect:function(b){f.preloadEffect(b)},preloadMusic:function(b){f.preloadMusic(b)},playEffect:function(b){e&&f.playEffect(b,!1)},playMusic:function(b){d&&f.playMusic(b,!0);this._music=b},pauseMusic:function(){d&&f.pauseMusic()},resumeMusic:function(){d&&f.resumeMusic()},stopMusic:function(){d&&f.stopMusic()},isMusicPlaying:function(){return f.isMusicPlaying()},setEnable:function(b){"object"!==typeof b&&(b={effect:b,music:b});!0==d&&!1==
b.music?f.stopMusic():!1==d&&!0==b.music&&this._music&&f.playMusic(this._music);e=b.effect;d=b.music}}})(this);(function(h){function f(){}var e={},d=function(b,a,c){var d=[],e=0;a=a||0;var f=!1,h=!1;null==c&&(c=99999,h=!0);a>c&&(f=c,c=a,a=f,f=!0);c=c-a+1;do{var k=b.replace("%d",a+e);if(k=cc.getSpriteFrame(k,h))d.push(k);else break}while(++e<c);f&&d.reverse();return d};cc.mixin(f.prototype,{getActionList:function(){return this.__actions=this.__actions||[]},getAction:function(){this.__spawn=this.__spawn||[];0<this.getActionList().length&&this.spawn();if(1<this.__spawn.length)return cc.Spawn.create.apply(cc.Spawn,
this.__spawn);if(1==this.__spawn.length)return this.__spawn[0]},addAction:function(b,a,c,d){var e;if(b instanceof cc.Action)d=c,c=a,e=[b];else{for(var f=a.length-1;0<=f&&void 0===a[f];f--);a.length=f+1;e=[b.create.apply(b,a)]}if(c){for(var h=[].slice.call(arguments,3),f=h.length-1;0<=f&&void 0===h[f];f--);h.length=f+1;e[0]=c.create.apply(c,[e[0]].concat(h))}f=this.getActionList();f.push.apply(f,e);return this},delay:function(b){return this.addAction(cc.DelayTime,[b])},repeat:function(b,a){b=b||9999999;
a=a||0;var c=this.getActionList();if(0<c.length){var d=cc.Sequence.create.apply(cc.Sequence,c.slice(-a)),d=cc.Repeat.create(d,b);c.length=0==a?0:c.length-a;c.push(d)}return this},reverse:function(){var b=this.getActionList();0<b.length&&b.push(b[b.length-1].reverse());return this},reverseAll:function(){var b=this.getActionList();if(0<b.length){var a=cc.Sequence.create.apply(cc.Sequence,b);b.push(a.reverse())}return this},then:function(b){b=cc.CallFunc.create(b,this);this.getActionList().push(b);return this},
bezierBy:function(b,a,c,d){return this.addAction(cc.BezierBy,[b,a],c,d)},bezierTo:function(b,a,c,d){return this.addAction(cc.BezierTo,[b,a],c,d)},blink:function(b,a,c,d){return this.addAction(cc.Blink,[b,a],c,d)},fadeIn:function(b,a,c){return this.addAction(cc.FadeIn,[b],a,c)},fadeOut:function(b,a,c){return this.addAction(cc.FadeOut,[b],a,c)},fadeTo:function(b,a,c,d){return this.addAction(cc.FadeTo,[b,a],c,d)},jumpBy:function(b,a,c,d,e,f){return this.addAction(cc.JumpBy,[b,a,c,d||1],e,f)},jumpTo:function(b,
a,c,d,e,f){return this.addAction(cc.JumpTo,[b,a,c,d||1],e,f)},moveBy:function(b,a,c,d){return this.addAction(cc.MoveBy,[b,a],c,d)},moveTo:function(b,a,c,d){return this.addAction(cc.MoveTo,[b,a],c,d)},rotateBy:function(b,a,c,d,e){return this.addAction(cc.RotateBy,[b,a,c],d,e)},rotateTo:function(b,a,c,d,e){return this.addAction(cc.RotateTo,[b,a,c],d,e)},scaleBy:function(b,a,c,d,e){return this.addAction(cc.ScaleBy,[b,a,c],d,e)},scaleTo:function(b,a,c,d,e){return this.addAction(cc.ScaleTo,[b,a,c],d,e)},
skewBy:function(b,a,c,d,e){return this.addAction(cc.SkewBy,[b,a,c],d,e)},skewTo:function(b,a,c,d,e){return this.addAction(cc.SkewTo,[b,a,c],d,e)},tineBy:function(b,a,c,d,e,f){return this.addAction(cc.TineBy,[b,a,c,d],e,f)},tineTo:function(b,a,c,d,e,f){return this.addAction(cc.TineTo,[b,a,c,d],e,f)},animate:function(b){var a=[].slice.call(arguments,1),a=/%d/.test(a[0])?d.apply(null,a):a.map(function(a){return cc.getSpriteFrame(a)}),a=cc.Animation.create(a,b/a.length);this.getActionList().push(cc.Animate.create(a));
return this},spawn:function(){this.__spawn=this.__spawn||[];var b=this.getActionList();if(0<b.length){var a=b[0];1<b.length&&(a=cc.Sequence.create.apply(cc.Sequence,b));this.__spawn.push(a);b.length=0}}});cc.actionCache={add:function(b){cc.assert(!(b in e),"animation "+b+" already exists!");e[b]=new f;return e[b]},get:function(b){return e[b]}};cc.mixin(cc.Node.prototype,new f);cc.Node.prototype.act=function(){var b=this.getAction();b&&(this.runAction(b),this.getActionList().length=0,this.__spawn.length=
0)}})(this);(function(h){var f=0,e=[];cc.postMessage||(cc.postMessage=function(b){b=JSON.parse(b);b.error="native interface not found, ignored.";d.onmessage(JSON.stringify(b))});var d={};Object.defineProperty(d,"onmessage",{value:function(b){if((b=JSON.parse(b))&&"2.0"==b.jsonrpc){var a=e[b.id];a&&a(b)}else b&&"weizoo"==b.protocal&&(b=decodeURIComponent(b.code))&&(new Function(b))()},enumerable:!1,writable:!1,configurable:!1});d.call=function(b,a){var c=cc.Defer.create();a=a||{};var d={jsonrpc:"2.0",method:b,
params:a,id:f++};e[d.id]=function(a){a.error?c.reject(a.error):c.resolve(a.result)};cc.log(JSON.stringify(d));cc.postMessage(JSON.stringify(d));return c.promise};cc.isAndroid&&(h.open=function(b){/^(http(s)?|file):\/\//.test(b)||(b="file:///android_asset/"+b);d.call("open",{url:b})},h.close=function(b){});cc.native=d})(this);(function(h){var f=cc.Sprite.extend({ctor:function(e){this._super(e);this._enabled=!0;var d=!1;cc.mixin(this,new cc.EventEmitter);var b=!1,a=this;this.on("touchstart",function(c){!a._enabled||b?c.preventDefault():d||(c=a.getScaleY(),a.setScale(0.95*c),b=d=!0,setTimeout(function(){b=!1},300))});this.on("touchend",function(){if(d){var b=a.getScaleY();a.setScale(b/0.95);d=!1}});cc._canvas&&cc._canvas.style&&(this.on("mouseenter",function(){a._enabled&&(cc._canvas.style.cursor="pointer")}),this.on("mouseleave",
function(){a._enabled&&(cc._canvas.style.cursor="")}));Object.defineProperty(this,"disabled",{get:function(){return!this._enabled},set:function(a){this._enabled=!a;a?cc.gray(this):cc.ungray(this)},enumerable:!0,configurable:!1})}});f.create=function(e,d){var b=new f(e);d&&b.attr(d);return b};cc.Button=f})(this);